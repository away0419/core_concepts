# 캐싱 전략 (Cache-aside / Write-through / Write-back)

캐시는 트래픽 폭증에서도 응답을 빠르게 유지해 주는 핵심 기술이다. 이 문서는 세 가지 대표 전략을 이해하고 올바르게 선택하는 데 초점을 맞춘다.

---

## 1. 용어 정리
- **Cache-aside (Lazy Loading)**  
  - 애플리케이션이 먼저 캐시를 조회하고, 없으면 DB에서 읽어 캐시에 넣는다.  
  - 가장 많이 쓰이는 패턴. TTL/무효화 전략이 중요.
- **Write-through**  
  - 쓰기 요청이 들어오면 먼저 캐시에 저장한 뒤 DB에도 동기화.  
  - 일관성이 높지만 쓰기 지연이 늘어난다.
- **Write-back (Write-behind)**  
  - 먼저 캐시에만 기록하고, 일정 주기마다 DB에 반영.  
  - 성능은 최고지만 장애 시 데이터 손실 리스크가 있으므로 주의가 필요.

---

## 2. 선택 기준
| 상황 | 권장 전략 | 이유 |
| --- | --- | --- |
| 읽기 비중이 매우 높은 서비스 | Cache-aside | 구현 단순, 대부분의 사례에 적합 |
| 쓰기와 읽기 모두 빠른 일관성이 필요 | Write-through | 캐시와 DB 동기화 유지 |
| 쓰기 부하가 폭발적이고 약간의 지연 허용 | Write-back | 쓰기를 버퍼링해 DB 부하를 줄임 |

---

## 3. 캐시 무효화 전략
- **TTL(Time To Live)**: 일정 시간이 지나면 자동 만료.
- **Explicit Invalidation**: 데이터 변경 시 관련 캐시 키를 직접 삭제.
- **Versioned Cache Key**: 스키마 변경 시 버전을 키에 포함.
- **Warm-up**: 배포 후 캐시를 미리 채워 cold-start를 방지.

---

## 4. 체크리스트
- [ ] 캐시 미스율, 히트율, TTL, 용량 등의 지표를 모니터링하고 있는가?
- [ ] 데이터 일관성 요구사항에 따라 적절한 전략을 선택했는가?
- [ ] 장애 시 캐시 삭제/재구축 절차를 문서화했는가?
- [ ] 캐시 서버 자체의 복제/샤딩/백업 전략을 갖고 있는가?

---

## 5. 실습 아이디어
- **실습 1**: Redis를 사용해 Cache-aside 패턴을 구현하고, TTL을 조정하며 성능을 비교한다.
- **실습 2**: Write-through/Write-back을 지원하는 캐시(예: Redis + Lua, Hazelcast, Couchbase)를 사용해 쓰기 지연 차이를 체험한다.
- **실습 3**: 배포 후 캐시 warming 스크립트를 작성해 cold-start를 방지해 본다.

