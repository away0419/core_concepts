# Consistent Hashing

Consistent Hashing은 노드 수가 변해도 키 재배치가 최소화되도록 설계된 해시 기법이다. 분산 캐시, 샤딩, 프록시 라우팅 등에서 널리 사용된다.

---

## 1. 기본 아이디어
- 모든 노드와 데이터를 해시 링(0~2³²) 위에 배치.
- 각 데이터 키는 링을 따라 시계방향으로 가장 먼저 등장하는 노드에 할당.
- 노드 추가/삭제 시 영향을 받는 키는 해당 노드 주변 일부만.

---

## 2. 개선 요소
- **Virtual Node**: 각 실제 노드를 여러 가상 노드로 표현해 데이터 분포를 고르게 만든다.
- **Replication**: 키를 여러 노드에 복제해 가용성을 확보.
- **Weight**: 노드 성능에 따라 가중치를 줘서 더 많은 키를 담당하게 함.

---

## 3. 적용 사례
- 분산 캐시(Memcached, Redis Cluster).
- CDN/프록시에서 백엔드 서버 선택.
- 분산 로그 수집(예: Kafka 파티션).

---

## 4. 체크리스트
- [ ] 노드 추가/삭제 시 재배치되는 키의 비율을 측정했는가?
- [ ] Virtual Node 개수와 가중치를 조정했는가?
- [ ] 해시 함수 충돌/편향을 테스트했는가?
- [ ] 재배치 시 캐시 워밍/데이터 이동 전략을 마련했는가?

---

## 5. 실습 아이디어
- **실습 1**: 간단한 Consistent Hashing 구현을 작성하고 노드 수를 바꿔 분포 변화를 시각화.
- **실습 2**: Virtual Node 개수를 바꿔 히스토그램을 비교.
- **실습 3**: Redis Cluster나 Amazon DynamoDB 같은 실제 서비스의 링 구조를 분석.

