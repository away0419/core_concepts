# Eventual Consistency

강한 일관성을 유지하기 어렵거나 비용이 큰 분산 시스템에서 자주 사용되는 모델이다. 이 문서는 개념과 설계 시 고려할 점을 정리한다.

---

## 1. 개념
- 모든 업데이트가 결국에는 모든 노드에 반영되어 동일한 상태가 된다.
- 반영까지 시간이 걸릴 수 있으므로, 잠시 동안은 오래된 데이터를 읽을 수 있다(Stale Read).

---

## 2. UX/비즈니스 관점
- 사용자에게 “작업이 완료되었음”을 보여주기 전에 실제로 반영되었는지 확인하는 방법 필요.
- 알림/이메일 등으로 후속 업데이트를 안내하거나, “곧 반영됩니다” 메시지를 제공.

---

## 3. 설계 패턴
- **SAGA**: 분산 트랜잭션을 보상(Compensation)으로 해결.
- **Read-your-write Consistency**: 같은 사용자가 자신의 최신 변경만큼은 즉시 볼 수 있도록 세션 캐시.
- **Version/Timestamp**: 데이터에 버전이나 타임스탬프를 붙여 최신 여부를 비교.
- **Conflict Resolution**: Last-write-wins, 벡터 클락, CRDT 등.

---

## 4. 체크리스트
- [ ] 지연 허용 범위(SLA)를 정의했는가? (몇 초 후에 동기화되면 되는가?)
- [ ] 동일 사용자의 최신 데이터 보장을 위한 전략(Read-your-write)을 마련했는가?
- [ ] 충돌 발생 시 자동/수동 해결 절차를 갖추었는가?
- [ ] 사용자에게 Eventually Consistent임을 적절히 안내하는가?

---

## 5. 실습 아이디어
- **실습 1**: DynamoDB/Cassandra에서 Consistency Level을 조정해 지연과 일관성 차이를 측정.
- **실습 2**: SAGA 패턴을 구현해 실패 시 보상 트랜잭션이 동작하는지 확인.
- **실습 3**: CRDT를 사용해 동시 업데이트에도 일관성을 유지하는 실습.

