# Aggregate 경계 정의

Aggregate는 관련된 Entity/Value Object를 하나의 일관성 경계로 묶은 것이다. 이 문서는 Aggregates를 설계하는 방법을 설명한다.

---

## 1. 핵심 규칙
- Aggregate는 항상 **단일 루트(Aggregate Root)**를 가진다.
- 외부에서는 루트를 통해서만 내부 객체에 접근한다.
- 트랜잭션은 Aggregate 단위로 유지한다(한 번에 여러 Aggregate 수정 지양).

---

## 2. 경계 설정 가이드
- 도메인 이벤트/업무 규칙을 분석해 “함께 변경되어야 하는 데이터”를 묶는다.
- 너무 크면 동시성/성능 저하, 너무 작으면 일관성 보장이 어려움.
- 읽기 모델(CQRS)에서는 Aggregate 경계를 완화할 수 있다.

---

## 3. 체크리스트
- [ ] Aggregate Root가 외부와의 유일한 통로인가?
- [ ] 불변 조건(invariant)을 Aggregate 내부에서만 유지해도 충분한가?
- [ ] 한 트랜잭션에서 여러 Aggregate를 수정해야 한다면 설계를 다시 검토했는가?
- [ ] 도메인 이벤트를 사용해 Aggregate 간 협력을 설계했는가?

---

## 4. 실습 아이디어
- **실습 1**: 주문(루트) – 주문항목(VO) – 결제정보 구조를 설계하며 불변 조건을 정의.
- **실습 2**: 기존 엔티티 관계도를 Aggregate 경계로 재그룹핑.
- **실습 3**: 여러 Aggregate가 협력해야 하는 시나리오에서 도메인 이벤트를 활용.

