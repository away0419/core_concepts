# Repository / Adapter / Facade 패턴

DDD와 계층형 아키텍처에서 자주 쓰이는 세 패턴을 정리한다.

---

## 1. Repository
- 도메인 객체 컬렉션(집합)을 추상화.
- `save`, `findById`, `findBy...` 등 도메인 친화적 API 제공.
- 인프라 세부사항(JPA, MyBatis, DynamoDB 등)을 감추어 테스트/교체가 쉽다.

### 체크포인트
- [ ] 도메인 용어로 메서드 이름을 짓고 있는가?
- [ ] 트랜잭션 범위와 Lazy 로딩을 고려했는가?
- [ ] 인터페이스/구현을 분리해 테스트 더블을 주입할 수 있는가?

## 2. Adapter
- 외부 시스템/Legacy와 내부 모델 사이의 변환 계층.
- 입력/출력을 내부 모델로 매핑해 핵심 도메인을 보호.
- Hexagonal Architecture에서 Port-Adapter 패턴과 동일한 개념.

### 체크포인트
- [ ] 외부 API 변경이 도메인까지 퍼지지 않도록 추상화했는가?
- [ ] 공통 예외/에러 변환 규칙을 갖고 있는가?

## 3. Facade
- 복잡한 하위 시스템을 단순한 인터페이스로 감싼다.
- 여러 서비스를 조합해 제공하거나, SDK 형태로 배포.

### 체크포인트
- [ ] 내부 복잡성을 숨기고, 클라이언트가 필요한 최소 기능만 제공하는가?
- [ ] Facade 내부 의존성 변경이 클라이언트에 영향을 주지 않는가?

---

## 4. 실습 아이디어
- **실습 1**: 외부 결제 API를 Adapter로 감싼 뒤 도메인 서비스가 인터페이스에만 의존하도록 리팩터링.
- **실습 2**: Repository 인터페이스를 테스트에서 In-memory 구현으로 대체.
- **실습 3**: Facade 클래스를 만들어 여러 도메인 서비스를 조합한 고수준 API를 제공.

